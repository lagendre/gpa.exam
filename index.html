<!DOCTYPE html>
<html>
    <head>
        <title>政府採購法111基礎班線上測驗</title>
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta charset="utf-8">
        <meta property="og:title" content="政府採購法111基礎班線上測驗">
        <meta property="og:description" content="以工程會產出的題庫為基礎，提供線上題庫練習">
        <meta property="og:type" content="website">
     	<meta name="theme-color" content="#6f42c1">
        <link href="//cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-1BmE4kWBq78iYhFldvKuhfTAU6auU8tT94WrHftjDbrCEXSU1oBoqyl2QvZ6jIW3" crossorigin="anonymous">
	<script src="//cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js" integrity="sha384-ka7Sk0Gln4gmtz2MlQnikT1wXgYsOg+OMhuP+IlRH9sENBO0LRn5q+8nbTov4+1p" crossorigin="anonymous"></script>
	<script src="//ajax.googleapis.com/ajax/libs/jquery/1.10.2/jquery.min.js"></script>
	<script src="IndexedDB.js"></script>

        <style>
	.navbar-expand-lg{
		background-color: #6f42c1; 
	}	
	.navbar-brand {
		width: 260px;
		overflow:hidden;
		white-space: nowrap;
		text-overflow: ellipsis;
	}
		
	#qa-quiz, #qa-answer, #qa-result{
			text-align:justify;
	}
	
	.btn-primary {
    		background-color: #6f42c1 !important;
		border-color:gray !important;
	}
	
	.nav>li>a {
   	 	
    		font-size: 16px !important;
	}
	.container{
		padding-top: 10px;
	}
	
	/*正確率顯示*/
	.frac {
    display: inline-block;
    position: relative;
    vertical-align: middle;
    letter-spacing: 0.001em;
    text-align: center;
	}
	.frac > span {
		display: block;	
	}
	.frac span.bottom {
		border-top: thin solid black;
	}
	.frac span.symbol {
		display: none;
	} 
	
	.percent{
		text-align:right;
		width:40px;
	}
	
	#qa-answer{
		font-size: 20pt;
	}
	
	#qa-stat{
		font-size:.75rem;
		text-align: center;
	}
	
	.progress{
		height: 20px;
	}


        </style>
    </head>
    <body>
		
    <!-- Fixed navbar -->
	<nav class="navbar navbar-expand-lg navbar-dark navbar-static-top" >
      <div class="container-fluid">
         <a class="navbar-brand d-md-block d-lg-none" href="#">採購法題庫</a>
		<button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
			<span class="navbar-toggler-icon"></span>
		</button>       
        <div id="navbar" class="navbar-collapse collapse">
         <ul class="nav navbar-nav">
        <li><a class="nav-link" href="#" >政府採購全生命週期概論</a></li>
		<li><a class="nav-link" href="#" >政府採購法之總則、招標及決標</a></li>
		<li><a class="nav-link" href="#" >政府採購法之履約管理及驗收</a></li>
		<li><a class="nav-link" href="#" >政府採購法之罰則及附則</a></li>
		<li><a class="nav-link" href="#" >政府採購法之爭議處理</a></li>
		<li><a class="nav-link" href="#" >底價及價格分析</a></li>
		<li><a class="nav-link" href="#" >投標須知及招標文件製作</a></li>
		<li><a class="nav-link" href="#" >採購契約</a></li>
		<li><a class="nav-link" href="#" >最有利標及評選優勝廠商</a></li>
		<li><a class="nav-link" href="#" >電子採購實務</a></li>
		<li><a class="nav-link" href="#" >工程及技術服務採購作業</a></li>
		<li><a class="nav-link" href="#" >財物及勞務採購作業</a></li>
		<li><a class="nav-link" href="#" >錯誤採購態樣</a></li>
		<li><a class="nav-link" href="#" >道德規範及違法處置</a></li>
		<li><a class="nav-link btn-outline-danger" href="#" >複習錯題</a></li>
          </ul>

        </div>
      </div>
    </nav>


		  <div class="container">
            <div class="row">          
                <h1 id="qa-quiz" class="col-md-12"></h1>
                <div id="qa-answer" class="col-md-12"></div>
                <h1 id="qa-result" class="col-md-12" ></h1>
                <div id="detail" class="col-md-12">
                    <div class="col-md-10 col-sm-12 col-xs-12">
                        <div class="d-flex btn-group btn-group-lg" role="group">
                            <button type="button" class="btn btn-primary  qa-previous" >
                                上一題
                            </button>
                            <button type="button" class="btn btn-primary  qa-jump" >
                                跳題
                            </button>
							<button type="button"class="btn btn-primary  qa-random" >
                                隨機
                            </button>
                            <button type="button" class="btn btn-primary qa-next">
                                下一題
                            </button>
                        </div>

						 <div class="row">
                        <div class="col-md-8">
						<div class="progress position-relative">
							<div class="progress-bar" role="progressbar" aria-valuenow="27" aria-valuemin="0" aria-valuemax="100"></div>
							<small class="justify-content-center d-flex position-absolute w-100">100%</small>
						</div>
						<div id="qa-stat">
						
						</div>
						</div>
						<div class="col-md-4">
						答對率：<div class="frac">
							<span class="top">100</span>
							<span class="symbol">/</span>
							<span class="bottom">100</span>
							</div>
						
						=<input value="100" class="percent"  readonly disabled />%
						</div>
					
						</div>
                    </div>
 
                </div>
            </div>
						
            <div style="text-align: center;">
                <a href="#" target="_blank" id="ori-pdf">原始題庫</a> |
                資料來源：<a href="https://web.pcc.gov.tw/psms/plrtqdm/questionPublic/indexReadQuestion" target="_blank">行政院工程會題庫</a>
            </div>
        </div>
     
        <script>
        var currentIndex = 0, qa = [], total = 0, sel_cnt=0, frac_top=0, frac_bottom=0;
        $(function() {
		
		
		$(".nav li:nth-child("+(Math.floor(Math.random() * $('.nav li').length )+1)+") a").addClass("active");
		
		selectquiz( $(".nav").find(".active").text() );
		
		$(".nav a").on("click", function(){
		
			$(".nav").find(".active").removeClass("active");
			$(this).addClass("active");
			
			if (  $(this).text() ==='複習錯題'){
				//sel_cnt=0; qa=[];
				
		
				getAllquiz(function(qadata, selcount){
					
					if ( qadata.length!=0 ){
						qa = qadata;sel_cnt = selcount;currentIndex=0;total = qa.length;
						showQuiz();
						$(".btn-outline-danger").text('清除錯題');
						$("a#ori-pdf").attr('href', '' )
							.text( '' );
					}
					else{
						alert('沒有錯題');
					}
				});
			
			}
			else if ( $(this).text() === '清除錯題' ){
				$(".btn-outline-danger").text('複習錯題');
				 clearquiz();
			}
			else{
				selectquiz( $(this).text() );	
			}
		});
	

          $('.qa-previous').click(function() {
            currentIndex -= 1;
            if(currentIndex < 0) {
              currentIndex = total - 1;
            }
            showQuiz();       
          });
          $('.qa-next').click(function() {
            currentIndex += 1;
            if(currentIndex >= total) {
              currentIndex = 0;
            }
            showQuiz();            
          });
          $('.qa-jump').click(function() {
            currentIndex = window.prompt('輸入 1-' + total + ' 數字');
            currentIndex = parseInt(currentIndex) - 1;
            showQuiz();            
          });
		
		$('.qa-random').click(function() {
	    currentIndex = Math.floor(Math.random() * qa.length);
            showQuiz();
          });
		  
	
        })

		
		function selectquiz(txt){
			
			if (txt === '複習錯題' || txt === '清除錯題'){

				return;
			}
			
			$(".btn-outline-danger").text('複習錯題');
			
			$("a#ori-pdf").attr("href", txt +'題庫.pdf' );
			
			
			$('.navbar-brand').text( txt );
			
			qa = [];
			
			$.get(txt+'題庫.txt', function(data) {
			
			let line = data.split('\r');
			let line_split =[];
			let section='';
				
			$("a#ori-pdf").attr("href", txt +'題庫.pdf' )
						.text( line[0].split('：')[1]+txt +'題庫' );	
			
			for (var i=0; i<line.length; i++){			
				if (line[i].replace(/\n/g, '') ==='選擇題')
					section = '選擇題';
				
				if (line[i].replace(/\n/g, '') ==='是非題'){
					section = '是非題';
					sel_cnt = qa.length;
					}
					
				if (line[i].replace(/\n/g, '') ==='依據法源'){
					if (section ==='選擇題')
						section = '選擇題&依據法源';
					else{
						section = '是非題&依據法源';
						sel_cnt = qa.length;
					}
				}
						
			switch ( section ) {
				
				case '選擇題':
						if( !isNaN(parseInt(line[i])) ){			

							line_split = line[i+2].split('(');
							qa.push({
							"quiz": line[i]+'.'+ line_split[0],
							"options": {
							"1": '('+line_split[1],
							"2": '('+line_split[2],
							"3": '('+line_split[3],
							"4": '('+line_split[4]
							},
							"answer":line[i+1],
							"ref":""
							});
						  i += 2;			
						}
					break;
				case '選擇題&依據法源':
					if( !isNaN(parseInt(line[i])) ){
						
							line_split = line[i+2].split('(');
							qa.push({
							"quiz": line[i]+'.'+line_split[0],
							"options": {
							"1": '('+line_split[1],
							"2": '('+line_split[2],
							"3": '('+line_split[3],
							"4": '('+line_split[4]
							},
							"answer":line[i+1],
							"ref": line[i+3]
							});
								
							i += 3;
					}
					break;	
				case '是非題':		
						if( !isNaN(parseInt(line[i])) ){					
							qa.push({
							"quiz": line[i]+'.'+line[i+2],
							"options": {
							"O": "O",
							"X": "X"
							},
							"answer":line[i+1],
							"ref": ""
							});
						
							i += 2;
						}
					break;
				case '是非題&依據法源':
					if( !isNaN(parseInt(line[i])) ){										
							qa.push({
							"quiz":line[i]+'.'+ line[i+2],
							"options": {
							"O": "O",
							"X": "X"
							},
							"answer":line[i+1],
							"ref": line[i+3]
							});
						
							i += 3;				
					}
					break;	
				default:
					//console.log(`nothing here:` + line[i] );
			}//end of switch
			
			}//end of for loop

			 total = qa.length;
			
			//random quiz
			currentIndex = Math.floor(Math.random() * qa.length);	
				
            showQuiz();
			
		}, 'text'); //end of get jquery
		}
		
        function showQuiz() {

		window.scrollTo(0, 0);
		
          if (currentIndex > qa.length)
			currentIndex=0;
			
		  $('#qa-result').html('');
          $('#qa-quiz').html(qa[currentIndex].quiz);
          var answers = '';
          for(k in qa[currentIndex].options) {
            answers +=  '<div class="form-check"><input class="form-check-input qa-options" type="radio" name="answer"  id="' + k + '" value="' + k + '">' +
						'<label class="form-check-label" for="'+ k +'">'+qa[currentIndex].options[k]+'</label></div>';
          }
          $('#qa-answer').html(answers);
		
          $('input.qa-options').change(function() {	      
            var selected = $(this).val();
            if(selected == qa[currentIndex].answer) {
				$('#qa-result').css({'color':'green'});
				
				$('#qa-result').html("你答對了！");
				
				frac_top++;frac_bottom++;
            } else {
				$('#qa-result').css({'color':'red'});
				
              $('#qa-result').html("你答錯了！正確答案應該是 -> " + qa[currentIndex].options[qa[currentIndex].answer] + "<br>"+ qa[currentIndex].ref );
			  frac_bottom++;
			  saveIndexedDB(qa[currentIndex]);
            }
			
			$('.frac span.bottom').text(frac_bottom);
			$('.frac span.top').text(frac_top);
			
			let pass= frac_top/frac_bottom*100;

			if ( pass < 70 )
				$('.percent').css({'color':'red','font-weight': 'bold'});				
			else
				$('.percent').css({'color':'green'});	
		
			$('.percent').val( (frac_top/frac_bottom*100).toFixed(1));
			
			window.scrollTo(0, document.body.scrollHeight);
          });
          //$('div#qa-status').html('第 ' + (currentIndex + 1) + ' 題 / 共 ' + total + ' 題(選擇：'+sel_cnt+' 是非：'+(total-sel_cnt)+')');
		  let valeur =((currentIndex + 1)/total*100).toFixed(1);
		  $('.progress-bar').css('width', valeur +'%')
							.attr('aria-valuenow', valeur);
		  $('.w-100').text(  (currentIndex + 1) + ' / ' + total + ' (題)');
		  $('div#qa-stat').html('選擇：'+sel_cnt+' 是非：'+(total-sel_cnt)+' (題)');
        }

        </script>
    </body>
</html>